(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5031c990"],{"176c":function(e,t,n){},"26e7":function(e,t,n){"use strict";n("176c")},"295a":function(e,t,n){},"42eb":function(e,t,n){"use strict";n("295a")},c740:function(e,t,n){"use strict";var i=n("23e7"),s=n("b727").findIndex,c=n("44d2"),a=n("ae40"),r="findIndex",o=!0,l=a(r);r in[]&&Array(1)[r]((function(){o=!1})),i({target:"Array",proto:!0,forced:o||!l},{findIndex:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),c(r)},f736:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-row",[n("input",{ref:"upload",staticStyle:{display:"none"},attrs:{type:"file",multiple:"",accept:"image/*"},on:{change:e.upload}}),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.$refs.upload.click()}}},[e._v("点击上传")]),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.remove}},[e._v("删除")])],1),n("ImageList",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"imageList",attrs:{images:e.list}})],1)},s=[],c=n("c7eb"),a=n("1da1"),r=n("5530"),o=(n("d3b7"),n("d81d"),n("a630"),n("3ca3"),n("caad"),n("2532"),n("159b"),n("99af"),n("b0c0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-checkbox",{staticStyle:{"margin-left":"10px"},attrs:{indeterminate:e.isIndeterminate},model:{value:e.allCheck,callback:function(t){e.allCheck=t},expression:"allCheck"}},[e._v(" 全选 ")]),n("span",{staticStyle:{"font-weight":"500","font-size":"14px"}},[e._v(" 已选 "),n("b",[e._v(e._s(e.selected.length))]),e._v(" 张")]),n("div",{staticClass:"image_list"},e._l(e.list,(function(t){return n("ImageItem",{key:t.id,staticClass:"img_box",attrs:{id:t.id,src:t.url,select:t.select},on:{onSelect:e.onSelect},scopedSlots:e._u([{key:"mark",fn:function(){return[n("div",{staticClass:"image_mask",on:{click:function(n){return e.openViewer(t.id)}}},[n("div",{staticClass:"mark_wrapper"},e._l(t.tags,(function(t,i){return n("span",{key:i},[e._v("#"+e._s(t))])})),0)])]},proxy:!0}],null,!0)})})),1),n("ElImageViewer",{directives:[{name:"show",rawName:"v-show",value:e.showViewer,expression:"showViewer"}],attrs:{"url-list":e.images.map((function(e){return e.url})),"initial-index":e.previewIndex,"on-close":e.closeViewer}})],1)}),l=[],u=(n("ddb0"),n("4de4"),n("c740"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{staticClass:"image_card",attrs:{"body-style":{padding:0,height:"100%",background:"rgba(135, 135, 135, 8%)"}}},[n("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.src,fit:"contain"}}),n("el-checkbox",{class:["checkbox","large"],on:{change:e.onSelect},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}}),e._t("mark")],2)}),d=[],h={props:{id:{type:String,required:!0},src:{type:String,default:""},select:{type:Boolean,default:!1}},data:function(){return{checked:!1}},watch:{select:function(e){this.checked=e}},methods:{onSelect:function(e){this.$emit("onSelect",e,this.id)}}},f=h,m=(n("26e7"),n("2877")),g=Object(m["a"])(f,u,d,!1,null,"67c3695c",null),p=g.exports,w={name:"ImageList",components:{ImageItem:p,ElImageViewer:function(){return Promise.all([n.e("chunk-elementUI"),n.e("chunk-626d92a9")]).then(n.bind(null,"ae72"))}},props:{images:{type:Array,default:function(e){return[]}}},data:function(){return{list:[],showViewer:!1,previewIndex:0}},computed:{allCheck:{get:function(){return this.list.length&&this.selected.length===this.list.length},set:function(e){this.list.forEach((function(t){t.select=e}))}},isIndeterminate:function(){return this.selected.length>0&&this.selected.length<this.list.length},selected:function(){return this.list.filter((function(e){return e.select}))}},watch:{images:function(e){this.list=e}},methods:{onSelect:function(e,t){this.list.forEach((function(n){n.id===t&&(n.select=e)}))},openViewer:function(e){this.previewIndex=this.images.findIndex((function(t){return t.id===e})),this.showViewer=!0,document.body.style.overflow="hidden"},closeViewer:function(){this.showViewer=!1,document.body.style.overflow="auto"}}},v=w,b=(n("42eb"),Object(m["a"])(v,o,l,!1,null,null,null)),k=b.exports,y={components:{ImageList:k},data:function(){return{loading:!1,list:[]}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.loading=!0,this.$oss.getList().then((function(t){e.list=t.objects.map((function(e,t){return Object(r["a"])(Object(r["a"])({id:"".concat(t)},e),{},{select:!1,tags:["test","hhh"]})}))})).finally((function(t){e.loading=!1}))},upload:function(e){var t=this;return Object(a["a"])(Object(c["a"])().mark((function n(){var i,s,a;return Object(c["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=Array.from(e.target.files),i.map((function(e){return e.type.includes("image")})).length===i.length){n.next=4;break}return t.$message.warning("仅支持图片格式"),n.abrupt("return");case 4:return s=0,i.forEach((function(e){e.uid="".concat(Date.now()).concat(s++)})),n.next=8,t.$oss.uploadList(i);case 8:a=n.sent,a.length===i.length&&(t.$message.success("上传成功"),t.getData());case 10:case"end":return n.stop()}}),n)})))()},remove:function(){var e=this,t=this.$refs.imageList.selected.map((function(e){return e.name}));this.$confirm("此操作将永久删除文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$oss.removeList(t).then((function(t){200===t.res.statusCode&&(e.$message.success("删除成功"),e.getData())}))})).catch((function(){}))}}},x=y,_=Object(m["a"])(x,i,s,!1,null,"63286f0e",null);t["default"]=_.exports}}]);